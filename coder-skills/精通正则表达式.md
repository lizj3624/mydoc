# 精通正则表达式
> 正则表达式(Regular Expression)是强大、便捷、高效处理文本处理工具。

完整的正则表达式由两种字符构成，元字符和普通文本字符

## 元字符
使用元字符可以编写更紧凑的正则表达式模式。常见的元字符如下：
- `\d`：相当于`[0-9]`，匹配任意数字。
- `\D`：相当于`[^0-9]`。
- `\w`：相当于`[0-9a-zA-Z]`，匹配任意数字、大小写字母和下划线。
- `\W`：相当于`[^0-9a-zA-Z]`。
- `\s`：相当于`[\t\v\n\r\f]`，匹配任意空白符，包括空格，水平制表符`\t`，垂直制表符`\v`，换行符`\n`，回车符`\r`，换页符`\f`。
- `\S`：相当于`[^\t\v\n\r\f]`，表示非空白符。

## 普通字符

## 特殊字符
使用特殊字符可以编写更高级的模式表达式，常见的特殊字符如下：
- `.`：匹配除了换行符之外的任何单个字符。
- `\`：将下一个字符标记为特殊字符、或原义字符、或向后引用、或八进制转义符。
- `|`：逻辑或操作符。
- `[^]`：取非，匹配未包含的任意字符。

## 修饰符
正则表达式常见的修饰符如下：
- `g`：表示全局模式，即运用于所有字符串。
- `i`：表示不区分大小写，即匹配时忽略字符串的大小写。
- `m`：表示多行模式，强制`$`和`^`分别匹配每个换行符。

## 行的起始和结束
脱字节`^`: 代表一行的开始
美元符`$`：代表一行的结束
```shell
egrep ^cat *.txt

egrep ^$ *.txt
```

## 字符组
```shell
# 0到9，a到z，A到Z的字符, -是连字符，是元字符
grep -E [0-9a-zA-Z] *.txt
```

## 排他型字符组
```shell
# 排查包含1-6的行
egrep [^1-6] *.txt

# 脱字节^在字符组内部才表示排他型

egrep 'q[^u]' worl.list
```

## 点号匹配任意字符

## 竖杠`|`匹配任意子表达式
   `|`是一个非常简洁的元字符，是或的意思

```shell
# 匹配行中包含Bob或者Robert的行
egrep 'Bob|Robert' *.txt

# 匹配行中包含grey或者gray的行
egrep 'gr[ea]y' *.txt

egrep 'gr(a|e)y' *.txt  # ()是必须的，表示字符的范围, 多选结构

# 字符组只能选择一个字符，多选结构可以选择多个字符

egrep '^(From|Subject|Date):*' *.txt
```

## 忽略大小写
```shell
egrep -i 'abc' *.txt
```

## 单词分界符
```shell
egrep '\<cat\>' *.txt
```

## 可选项元素
```shell
# ?前面的u可有可无
egrep 'colou?r' *.txt
```

## 量词: 加号`+`, 星号`*`
`+`表示之前紧邻的元素出现一次或者多次

`*`表示之前紧邻的元素出现任意多次，或者不出现

## 区间`{min, max}`
> 问号?对应区间{0, 1}
```shell
# 匹配出现1-5次的大小写字母
egrep '[a-zA-Z]{1, 5}' *.txt
```

## 转义 `\( \)`

## 间记法

1. `\t`: 制表符

2. `\n`: 换行符

3. `\r`: 回车符

4. `\s`: 任何空白字符(空格，制表符，进纸符)

5. `\S`: 除`\s`外任何字符

6. `\w`: [a-zA-Z0-9](在`\w+`中很有用，匹配一个单词)

7. `\W`: 除`\w`外的任何字符

8. `\d`: [0-9]数字

9. `\D`: 除[0-9]以外的任何字符


## 贪婪和非贪婪 
属于贪婪模式的量词，也叫做匹配优先量词，包括：
```shell
{m,n}、{m,}、?、*、+
```
在一些使用NFA引擎的语言中，在匹配优先量词后加上`?`，即变成属于非贪婪模式的量词，也叫做忽略优先量词，包括：
```shell
{m,n}?、{m,}?、??、*?、+?
```
从正则语法的角度来讲，被匹配优先量词修饰的子表达式使用的就是贪婪模式，如`(Expression)+`；
被忽略优先量词修饰的子表达式使用的就是非贪婪模式，如`(Expression)+?`。

## 单行和多行匹配
1. 单行模式
关键字： `s`，(.)点号不匹配换行符，并不是刻意匹配任意字符，在单行模式下会改变点号的含义，做到匹配任意字符

2. 多行模式
关键字：`m`，多行模式下^和$的含义会被改变，普通的含义是匹配整个字符串的开头和结尾，
在多行模式下匹配的就是每一行的行首和行尾，而`\A`和`\Z`他们的含义始终是匹配整个字符串的开头和结尾
```shell
(?mi)^[\s]{0,}upstream[\s]{1,}([^\s{]+)[\s]{0,}[{]?[\s]{0,}$
```

## 引用
1. [正则表达式大全](https://tool.oschina.net/uploads/apidocs/jquery/regexp.html)

2. [一篇带给你正则表达式完整指南](https://www.51cto.com/article/710479.html)

3. [Go正则表达式示例](https://colobu.com/2020/11/11/golang-regex-replace-example/)
